<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ProductMapper">

	<resultMap type="Product" id="productResultMap">
		<id property="productNo" column="PRODUCT_NO"/>
		<result property="categoryNo" column="CATEGORY_NO"/>
		<result property="productName" column="PRODUCT_NAME"/>
		<result property="productPrice" column="PRODUCT_PRICE"/>
		<result property="productDescription" column="PRODUCT_DESCRIPTION"/>
		<result property="productFilename" column="PRODUCT_FILENAME"/>
		<result property="productFilerename" column="PRODUCT_FILERENAME"/>
		<result property="productFilepath" column="PRODUCT_FILEPATH"/>
	</resultMap>
		<resultMap type="Category" id="categoryResultMap">
		<id property="categoryNo" column="CATEGORY_NO"/>
		<result property="categoryName" column="CATEGORY_NAME"/>
	</resultMap>

	<select id="getListCount" resultType="_int">
		SELECT COUNT(*) FROM PRODUCT_TBL
	</select>
	
	<select id="getSearchListCount" resultType="_int">
		SELECT COUNT(*) FROM PRODUCT_TBL
		<choose>
			<when test="searchCondition == 'no'">
				WHERE PRODUCT_NO LIKE '%' || #{searchValue} || '%'
			</when>
			<when test="searchCondition == 'title'">
				WHERE PRODUCT_NAME LIKE '%' || #{searchValue} || '%'
			</when>
			<when test="searchCondition == 'description'">
				WHERE PRODUCT_DESCRIPTION LIKE '%' || #{searchValue} || '%'
			</when>
		</choose>
	</select>
	
	<select id="selectProductList" resultMap="productResultMap">
	  SELECT PRODUCT_NO, PRODUCT_NAME, PRODUCT_PRICE, PRODUCT_FILENAME
	  FROM PRODUCT_TBL
	  ORDER BY CATEGORY_NO
	</select>

	<select id="selectListByKeyword" resultMap="productResultMap">
		SELECT * FROM PRODUCT_TBL 
		<if test="searchCondition == 'all'">
			WHERE PRODUCT_NO LIKE '%' || #{searchValue} || '%'
			OR PRODUCT_NAME LIKE '%' || #{searchValue} || '%'
			OR PRODUCT_DESCRIPTION LIKE '%' || #{searchValue} || '%'
		</if>
		<if test="searchCondition == 'no'">
			WHERE PRODUCT_NO LIKE '%' || #{searchValue} || '%'
		</if>
		<if test="searchCondition == 'title'">
			WHERE PRODUCT_NAME LIKE '%' || #{searchValue} || '%'
		</if>
		<if test="searchCondition == 'description'">
			WHERE PRODUCT_DESCRIPTION LIKE '%' || #{searchValue} || '%'
		</if>
		ORDER BY PRODUCT_NO DESC
	</select>
</mapper>